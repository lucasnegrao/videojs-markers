{"version":3,"sources":["videojs-markers.js"],"names":["video_js_1","exports","__esModule","defaultSetting","markerStyle","markerTip","display","text","marker","time","breakOverlay","displayTime","overlayText","style","onMarkerClick","onMarkerReached","index","markers","generateUUID","d","Date","getTime","uuid","replace","c","r","Math","random","floor","toString","getElementBounding","element","elementBounding","defaultBoundingRect","top","bottom","left","width","height","right","getBoundingClientRect","e","NULL_INDEX","registerVideoJsMarkersPlugin","options","mergeOptions","isPlain","value","call","constructor","Object","source1","source2","result","sources","forEach","source","keys","key","dom","createEl","tagName","props","attrs","el","Player","prototype","setAttribute","setting","markersMap","markersList","currentMarkerIndex","player","overlayIndex","sortMarkersList","sort","a","b","i","addMarkers","newMarkers","querySelector","appendChild","createMarkerDiv","push","getPosition","duration","setMarkderDivStyle","markerDiv","className","concat","ratio","marginLeft","markerDivBounding","addEventListener","preventDefault","getAttribute","currentTime","registerMarkerTipHandler","updateMarkers","force","markerTime","removeMarkers","indexArray","visibility","deleteIndexList","parentNode","removeChild","reverse","deleteIndex","splice","html","innerHTML","innerText","markerTipBounding","parseFloat","initializeMarkerTip","updateBreakOverlay","initializeOverlay","onTimeUpdate","onUpdateMarker","onTimeUpdateAfterMarkerUpdate","length","getNextMarkerTime","newMarkerIndex","nextMarkerTime","initialize","removeAll","on","off","getMarkers","next","prev","add","remove","updateTime","reset","destroy","registerPlugin"],"mappings":"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","file":"videojs-markers.js","sourcesContent":["/*! videojs-markers - v1.0.1 - 2022-05-03\n* Copyright (c) 2022 ; Licensed  */\n'use strict';\nexports.__esModule = true;\nvar video_js_1 = require(\"video.js\");\n// default setting\nvar defaultSetting = {\n    markerStyle: {\n        'width': '7px',\n        'border-radius': '30%',\n        'background-color': 'red'\n    },\n    markerTip: {\n        display: true,\n        text: function (marker) {\n            return \"Break: \" + marker.text;\n        },\n        time: function (marker) {\n            return marker.time;\n        }\n    },\n    breakOverlay: {\n        display: false,\n        displayTime: 3,\n        text: function (marker) {\n            return \"Break overlay: \" + marker.overlayText;\n        },\n        style: {\n            'width': '100%',\n            'height': '20%',\n            'background-color': 'rgba(0,0,0,0.7)',\n            'color': 'white',\n            'font-size': '17px'\n        }\n    },\n    onMarkerClick: function (marker) { },\n    onMarkerReached: function (marker, index) { },\n    markers: []\n};\n// create a non-colliding random number\nfunction generateUUID() {\n    var d = new Date().getTime();\n    var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n        var r = (d + Math.random() * 16) % 16 | 0;\n        d = Math.floor(d / 16);\n        return (c == 'x' ? r : (r & 0x3 | 0x8)).toString(16);\n    });\n    return uuid;\n}\n;\n/**\n * Returns the size of an element and its position\n * a default Object with 0 on each of its properties\n * its return in case there's an error\n * @param  {Element} element  el to get the size and position\n * @return {DOMRect|Object}   size and position of an element\n */\nfunction getElementBounding(element) {\n    var elementBounding;\n    var defaultBoundingRect = {\n        top: 0,\n        bottom: 0,\n        left: 0,\n        width: 0,\n        height: 0,\n        right: 0\n    };\n    try {\n        elementBounding = element.getBoundingClientRect();\n    }\n    catch (e) {\n        elementBounding = defaultBoundingRect;\n    }\n    return elementBounding;\n}\nvar NULL_INDEX = -1;\nfunction registerVideoJsMarkersPlugin(options) {\n    // copied from video.js/src/js/utils/merge-options.js since\n    // videojs 4 doens't support it by defualt.\n    if (!video_js_1[\"default\"].mergeOptions) {\n        function isPlain(value) {\n            return !!value && typeof value === 'object' &&\n                toString.call(value) === '[object Object]' &&\n                value.constructor === Object;\n        }\n        function mergeOptions(source1, source2) {\n            var result = {};\n            var sources = [source1, source2];\n            sources.forEach(function (source) {\n                if (!source) {\n                    return;\n                }\n                Object.keys(source).forEach(function (key) {\n                    var value = source[key];\n                    if (!isPlain(value)) {\n                        result[key] = value;\n                        return;\n                    }\n                    if (!isPlain(result[key])) {\n                        result[key] = {};\n                    }\n                    result[key] = mergeOptions(result[key], value);\n                });\n            });\n            return result;\n        }\n        video_js_1[\"default\"].mergeOptions = mergeOptions;\n    }\n    if (!video_js_1[\"default\"].dom.createEl) {\n        video_js_1[\"default\"].dom.createEl = function (tagName, props, attrs) {\n            var el = video_js_1[\"default\"].Player.prototype.dom.createEl(tagName, props);\n            if (!!attrs) {\n                Object.keys(attrs).forEach(function (key) {\n                    el.setAttribute(key, attrs[key]);\n                });\n            }\n            return el;\n        };\n    }\n    /**\n     * register the markers plugin (dependent on jquery)\n     */\n    var setting = video_js_1[\"default\"].mergeOptions(defaultSetting, options), markersMap = {}, markersList = [], // list of markers sorted by time\n    currentMarkerIndex = NULL_INDEX, player = this, markerTip = null, breakOverlay = null, overlayIndex = NULL_INDEX;\n    function sortMarkersList() {\n        // sort the list by time in asc order\n        markersList.sort(function (a, b) {\n            return setting.markerTip.time(a) - setting.markerTip.time(b);\n        });\n        markersList.forEach(function (e, i) { return e.index = i; });\n    }\n    function addMarkers(newMarkers) {\n        newMarkers.forEach(function (marker) {\n            marker.key = generateUUID();\n            player.el().querySelector('.vjs-progress-holder')\n                .appendChild(createMarkerDiv(marker));\n            // store marker in an internal hash map\n            markersMap[marker.key] = marker;\n            markersList.push(marker);\n        });\n        sortMarkersList();\n    }\n    function getPosition(marker) {\n        return (setting.markerTip.time(marker) / player.duration()) * 100;\n    }\n    function setMarkderDivStyle(marker, markerDiv) {\n        markerDiv.className = \"vjs-marker \".concat(marker[\"class\"] || \"\");\n        Object.keys(setting.markerStyle).forEach(function (key) {\n            markerDiv.style[key] = setting.markerStyle[key];\n        });\n        // hide out-of-bound markers\n        var ratio = marker.time / player.duration();\n        if (ratio < 0 || ratio > 1) {\n            markerDiv.style.display = 'none';\n        }\n        // set position\n        markerDiv.style.left = getPosition(marker) + '%';\n        if (marker.duration) {\n            markerDiv.style.width = (marker.duration / player.duration()) * 100 + '%';\n            markerDiv.style.marginLeft = '0px';\n        }\n        else {\n            var markerDivBounding = getElementBounding(markerDiv);\n            markerDiv.style.marginLeft = markerDivBounding.width / 2 + 'px';\n        }\n    }\n    function createMarkerDiv(marker) {\n        var markerDiv = video_js_1[\"default\"].dom.createEl('div', {}, {\n            'data-marker-key': marker.key,\n            'data-marker-time': setting.markerTip.time(marker)\n        });\n        setMarkderDivStyle(marker, markerDiv);\n        // bind click event to seek to marker time\n        markerDiv.addEventListener('click', function (e) {\n            var preventDefault = false;\n            if (typeof setting.onMarkerClick === \"function\") {\n                // if return false, prevent default behavior\n                preventDefault = setting.onMarkerClick(marker) === false;\n            }\n            if (!preventDefault) {\n                var key = this.getAttribute('data-marker-key');\n                player.currentTime(setting.markerTip.time(markersMap[key]));\n            }\n        });\n        if (setting.markerTip.display) {\n            registerMarkerTipHandler(markerDiv);\n        }\n        return markerDiv;\n    }\n    function updateMarkers(force) {\n        // update UI for markers whose time changed\n        markersList.forEach(function (marker) {\n            var markerDiv = player.el().querySelector(\".vjs-marker[data-marker-key='\" + marker.key + \"']\");\n            var markerTime = setting.markerTip.time(marker);\n            if (force || markerDiv.getAttribute('data-marker-time') !== markerTime) {\n                setMarkderDivStyle(marker, markerDiv);\n                markerDiv.setAttribute('data-marker-time', markerTime);\n            }\n        });\n        sortMarkersList();\n    }\n    function removeMarkers(indexArray) {\n        // reset overlay\n        if (!!breakOverlay) {\n            overlayIndex = NULL_INDEX;\n            breakOverlay.style.visibility = \"hidden\";\n        }\n        currentMarkerIndex = NULL_INDEX;\n        var deleteIndexList = [];\n        indexArray.forEach(function (index) {\n            var marker = markersList[index];\n            if (marker) {\n                // delete from memory\n                delete markersMap[marker.key];\n                deleteIndexList.push(index);\n                // delete from dom\n                var el = player.el().querySelector(\".vjs-marker[data-marker-key='\" + marker.key + \"']\");\n                el && el.parentNode.removeChild(el);\n            }\n        });\n        // clean up markers array\n        deleteIndexList.reverse();\n        deleteIndexList.forEach(function (deleteIndex) {\n            markersList.splice(deleteIndex, 1);\n        });\n        // sort again\n        sortMarkersList();\n    }\n    // attach hover event handler\n    function registerMarkerTipHandler(markerDiv) {\n        markerDiv.addEventListener('mouseover', function () {\n            var marker = markersMap[markerDiv.getAttribute('data-marker-key')];\n            if (!!markerTip) {\n                if (setting.markerTip.html) {\n                    markerTip.querySelector('.vjs-tip-inner').innerHTML = setting.markerTip.html(marker);\n                }\n                else {\n                    markerTip.querySelector('.vjs-tip-inner').innerText = setting.markerTip.text(marker);\n                }\n                // margin-left needs to minus the padding length to align correctly with the marker\n                markerTip.style.left = getPosition(marker) + '%';\n                var markerTipBounding = getElementBounding(markerTip);\n                var markerDivBounding = getElementBounding(markerDiv);\n                markerTip.style.marginLeft =\n                    -parseFloat(markerTipBounding.width / 2) + parseFloat(markerDivBounding.width / 4) + 'px';\n                markerTip.style.visibility = 'visible';\n            }\n        });\n        markerDiv.addEventListener('mouseout', function () {\n            if (!!markerTip) {\n                markerTip.style.visibility = \"hidden\";\n            }\n        });\n    }\n    function initializeMarkerTip() {\n        markerTip = video_js_1[\"default\"].dom.createEl('div', {\n            className: 'vjs-tip',\n            innerHTML: \"<div class='vjs-tip-arrow'></div><div class='vjs-tip-inner'></div>\"\n        });\n        player.el().querySelector('.vjs-progress-holder').appendChild(markerTip);\n    }\n    // show or hide break overlays\n    function updateBreakOverlay() {\n        if (!setting.breakOverlay.display || currentMarkerIndex < 0) {\n            return;\n        }\n        var currentTime = player.currentTime();\n        var marker = markersList[currentMarkerIndex];\n        var markerTime = setting.markerTip.time(marker);\n        if (currentTime >= markerTime &&\n            currentTime <= (markerTime + setting.breakOverlay.displayTime)) {\n            if (overlayIndex !== currentMarkerIndex) {\n                overlayIndex = currentMarkerIndex;\n                if (breakOverlay) {\n                    breakOverlay.querySelector('.vjs-break-overlay-text').innerHTML = setting.breakOverlay.text(marker);\n                }\n            }\n            if (breakOverlay) {\n                breakOverlay.style.visibility = \"visible\";\n            }\n        }\n        else {\n            overlayIndex = NULL_INDEX;\n            if (breakOverlay) {\n                breakOverlay.style.visibility = \"hidden\";\n            }\n        }\n    }\n    // problem when the next marker is within the overlay display time from the previous marker\n    function initializeOverlay() {\n        breakOverlay = video_js_1[\"default\"].dom.createEl('div', {\n            className: 'vjs-break-overlay',\n            innerHTML: \"<div class='vjs-break-overlay-text'></div>\"\n        });\n        Object.keys(setting.breakOverlay.style).forEach(function (key) {\n            if (breakOverlay) {\n                breakOverlay.style[key] = setting.breakOverlay.style[key];\n            }\n        });\n        player.el().appendChild(breakOverlay);\n        overlayIndex = NULL_INDEX;\n    }\n    function onTimeUpdate() {\n        onUpdateMarker();\n        updateBreakOverlay();\n        options.onTimeUpdateAfterMarkerUpdate && options.onTimeUpdateAfterMarkerUpdate();\n    }\n    function onUpdateMarker() {\n        /*\n          check marker reached in between markers\n          the logic here is that it triggers a new marker reached event only if the player\n          enters a new marker range (e.g. from marker 1 to marker 2). Thus, if player is on marker 1 and user clicked on marker 1 again, no new reached event is triggered)\n        */\n        if (!markersList.length) {\n            return;\n        }\n        var getNextMarkerTime = function (index) {\n            if (index < markersList.length - 1) {\n                return setting.markerTip.time(markersList[index + 1]);\n            }\n            // next marker time of last marker would be end of video time\n            return player.duration();\n        };\n        var currentTime = player.currentTime();\n        var newMarkerIndex = NULL_INDEX;\n        if (currentMarkerIndex !== NULL_INDEX) {\n            // check if staying at same marker\n            var nextMarkerTime = getNextMarkerTime(currentMarkerIndex);\n            if (currentTime >= setting.markerTip.time(markersList[currentMarkerIndex]) &&\n                currentTime < nextMarkerTime) {\n                return;\n            }\n            // check for ending (at the end current time equals player duration)\n            if (currentMarkerIndex === markersList.length - 1 &&\n                currentTime === player.duration()) {\n                return;\n            }\n        }\n        // check first marker, no marker is selected\n        if (currentTime < setting.markerTip.time(markersList[0])) {\n            newMarkerIndex = NULL_INDEX;\n        }\n        else {\n            // look for new index\n            for (var i = 0; i < markersList.length; i++) {\n                nextMarkerTime = getNextMarkerTime(i);\n                if (currentTime >= setting.markerTip.time(markersList[i]) &&\n                    currentTime < nextMarkerTime) {\n                    newMarkerIndex = i;\n                    break;\n                }\n            }\n        }\n        // set new marker index\n        if (newMarkerIndex !== currentMarkerIndex) {\n            // trigger event if index is not null\n            if (newMarkerIndex !== NULL_INDEX && options.onMarkerReached) {\n                options.onMarkerReached(markersList[newMarkerIndex], newMarkerIndex);\n            }\n            currentMarkerIndex = newMarkerIndex;\n        }\n    }\n    // setup the whole thing\n    function initialize() {\n        if (setting.markerTip.display) {\n            initializeMarkerTip();\n        }\n        // remove existing markers if already initialized\n        player.markers.removeAll();\n        addMarkers(setting.markers);\n        if (setting.breakOverlay.display) {\n            initializeOverlay();\n        }\n        onTimeUpdate();\n        player.on(\"timeupdate\", onTimeUpdate);\n        player.off(\"loadedmetadata\");\n    }\n    // setup the plugin after we loaded video's meta data\n    player.on(\"loadedmetadata\", function () {\n        initialize();\n    });\n    // exposed plugin API\n    player.markers = {\n        getMarkers: function () {\n            return markersList;\n        },\n        next: function () {\n            // go to the next marker from current timestamp\n            var currentTime = player.currentTime();\n            for (var i = 0; i < markersList.length; i++) {\n                var markerTime = setting.markerTip.time(markersList[i]);\n                if (markerTime > currentTime) {\n                    player.currentTime(markerTime);\n                    break;\n                }\n            }\n        },\n        prev: function () {\n            // go to previous marker\n            var currentTime = player.currentTime();\n            for (var i = markersList.length - 1; i >= 0; i--) {\n                var markerTime = setting.markerTip.time(markersList[i]);\n                // add a threshold\n                if (markerTime + 0.5 < currentTime) {\n                    player.currentTime(markerTime);\n                    return;\n                }\n            }\n        },\n        add: function (newMarkers) {\n            // add new markers given an array of index\n            addMarkers(newMarkers);\n        },\n        remove: function (indexArray) {\n            // remove markers given an array of index\n            removeMarkers(indexArray);\n        },\n        removeAll: function () {\n            var indexArray = [];\n            for (var i = 0; i < markersList.length; i++) {\n                indexArray.push(i);\n            }\n            removeMarkers(indexArray);\n        },\n        // force - force all markers to be updated, regardless of if they have changed or not.\n        updateTime: function (force) {\n            // notify the plugin to update the UI for changes in marker times\n            updateMarkers(force);\n        },\n        reset: function (newMarkers) {\n            // remove all the existing markers and add new ones\n            player.markers.removeAll();\n            addMarkers(newMarkers);\n        },\n        destroy: function () {\n            // unregister the plugins and clean up even handlers\n            player.markers.removeAll();\n            breakOverlay && breakOverlay.remove();\n            markerTip && markerTip.remove();\n            player.off(\"timeupdate\", updateBreakOverlay);\n            delete player.markers;\n        }\n    };\n}\nvideo_js_1[\"default\"].registerPlugin('markers', registerVideoJsMarkersPlugin);\n"]}